{{/*
  Custom Sidebar - LLM-Optimized Documentation
  
  Flattened navigation structure with LLM-optimized indicators.
  All sections always expanded, no collapsing.
  
  Requirements: 4.1, 4.2, 4.3
*/}}

{{/* Get the docs section - use language-aware path */}}
{{ $docsSection := .Site.GetPage "docs" }}

<nav id="td-section-nav" class="td-sidebar-nav" aria-label="Documentation navigation">
  <ul class="td-sidebar-nav-list">
    {{/* Iterate through top-level sections */}}
    {{ range $docsSection.Sections }}
      {{ $isActive := or (eq $.RelPermalink .RelPermalink) ($.IsDescendant .) }}
      {{ $isLLMOptimized := .Params.llm_optimized | default false }}
      {{ $hasChildren := gt (len .Pages) 0 }}
      
      <li class="td-sidebar-nav-item{{ if $isActive }} active-path{{ end }}">
        {{/* Section link - bold title */}}
        <a href="{{ .RelPermalink }}" 
           class="td-sidebar-nav-link td-sidebar-nav-link--section{{ if eq $.RelPermalink .RelPermalink }} active{{ end }}"
           id="m-{{ .RelPermalink | anchorize }}">
          <span class="nav-link-text">{{ .LinkTitle }}</span>
        </a>
        
        {{/* Always show child pages - no collapsing */}}
        {{ if $hasChildren }}
        <ul class="td-sidebar-nav-sublist">
          {{ range .Pages }}
            {{ $childActive := eq $.RelPermalink .RelPermalink }}
            <li class="td-sidebar-nav-subitem">
              <a href="{{ .RelPermalink }}" 
                 class="td-sidebar-nav-sublink{{ if $childActive }} active{{ end }}"
                 id="m-{{ .RelPermalink | anchorize }}">
                <span class="nav-link-text">{{ .LinkTitle }}</span>
              </a>
            </li>
          {{ end }}
        </ul>
        {{ end }}
      </li>
    {{ end }}
  </ul>
</nav>

